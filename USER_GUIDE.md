# SpotifyExportTool 用户指南

本指南将帮助您了解如何安装、配置和使用 SpotifyExportTool 来管理和导出您的 Spotify 播放列表。

## 目录

1. [安装指南](#安装指南)
2. [初次使用](#初次使用)
3. [主界面介绍](#主界面介绍)
4. [播放列表管理](#播放列表管理)
5. [导出功能](#导出功能)
6. [应用设置](#应用设置)
7. [常见问题](#常见问题)
8. [故障排除](#故障排除)
9. [快捷键](#快捷键)
10. [隐私说明](#隐私说明)

## 安装指南

### Windows 用户

1. 从[发布页面](https://github.com/Cail-Gainey/SpotifyExportTool/releases)下载最新的 `SpotifyExportTool.zip` 文件
2. 解压缩到您选择的目录
3. 双击 `SpotifyExportTool.exe` 启动应用程序
4. （可选）右键点击应用程序图标，选择"创建快捷方式"，将快捷方式放到桌面或开始菜单

### Mac 用户

1. 从[发布页面](https://github.com/Cail-Gainey/SpotifyExportTool/releases)下载最新的 `SpotifyExportTool.dmg` 文件
2. 打开 DMG 文件
3. 将 SpotifyExportTool 拖动到应用程序文件夹
4. 从应用程序文件夹或 Launchpad 启动 SpotifyExportTool
5. 首次运行时，您可能需要右键点击应用程序图标并选择"打开"以绕过 macOS 的安全限制

### 从源代码运行

如果您想从源代码运行应用程序：

1. 确保您已安装 Python 3.7 或更高版本
2. 克隆代码库：
   ```
   git clone https://github.com/Cail-Gainey/SpotifyExportTool.git
   cd SpotifyExportTool
   ```
3. 安装依赖：
   ```
   pip install -r requirements.txt
   ```
4. 运行应用程序：
   ```
   python main.py
   ```

## 初次使用

### Spotify 授权流程

1. 启动应用程序后，您将看到登录界面
2. 点击"使用 Spotify 账号登录"按钮
3. 系统将在您的默认浏览器中打开 Spotify 授权页面
4. 使用您的 Spotify 账号登录
5. 授权应用程序访问您的 Spotify 数据（应用程序只请求读取权限，不会修改您的播放列表）
6. 授权成功后，浏览器会显示成功信息，您可以关闭浏览器页面
7. 应用程序会自动检测授权状态并进入主界面

### 授权令牌管理

- 授权成功后，应用程序会保存一个访问令牌，用于后续访问您的 Spotify 数据
- 令牌会自动刷新，通常您不需要频繁重新登录
- 如果您想撤销授权，可以在 Spotify 账号设置中的"应用程序"部分找到并删除 SpotifyExportTool 的访问权限

### 授权问题解决

如果授权过程中遇到问题：

1. 确保您的网络连接正常
2. 检查是否有防火墙或安全软件阻止应用程序连接
3. 点击登录界面的"重试"按钮再次尝试
4. 如果问题持续，请检查日志文件（在设置页面中可以查看）
5. 确保您的系统时间是准确的，时间不准确可能导致授权失败

## 主界面介绍

SpotifyExportTool 的主界面分为几个主要区域：

### 顶部栏

- **左侧**：应用标题和版本信息
- **中间**：搜索框（可以搜索播放列表和歌曲）
- **右侧**：用户头像、设置按钮和其他功能按钮

### 侧边栏（左侧）

- 显示您的所有 Spotify 播放列表
- 可折叠/展开以节省空间（点击侧边栏顶部的折叠按钮）
- 包含刷新按钮，用于更新播放列表数据
- 播放列表按照 Spotify 中的顺序排列

### 主内容区域

- 显示选定播放列表的歌曲
- 包含导出按钮和其他操作选项
- 初次登录时显示欢迎页面
- 歌曲列表支持排序（点击列标题）和搜索

## 播放列表管理

### 浏览播放列表

1. 在左侧边栏中可以看到您的所有播放列表
2. 点击任意播放列表查看其中的歌曲
3. 播放列表内容会显示在主区域，包括歌曲名称、艺术家、专辑和时长
4. 在折叠模式下，侧边栏只显示播放列表封面图标

### 搜索功能

1. 使用顶部的搜索框可以搜索播放列表或歌曲
2. 在播放列表视图中搜索将过滤当前播放列表中的歌曲
3. 搜索支持歌曲名称、艺术家和专辑名称

### 刷新播放列表

如果您在 Spotify 中创建了新的播放列表或修改了现有播放列表：

1. 点击侧边栏顶部的刷新按钮（↻）
2. 应用程序将从 Spotify 获取最新数据
3. 刷新完成后，您将看到更新后的播放列表
4. 刷新过程中，会显示加载指示器

### 播放列表详情

查看播放列表时，您可以看到以下信息：

- 播放列表名称和封面
- 创建者信息
- 歌曲总数
- 播放列表描述（如果有）
- 所有歌曲的详细信息

## 导出功能

SpotifyExportTool 允许您以多种格式导出播放列表：

### 导出步骤

1. 选择您想要导出的播放列表
2. 点击播放列表页面顶部的"导出"按钮
3. 在弹出的导出对话框中设置：
   - **文件格式**：选择 TXT 或 CSV
   - **内容格式**：选择歌名-歌手、歌手-歌名或歌名-歌手-专辑
   - **包含标题行**：（CSV格式）是否在第一行添加列标题
   - **分隔符**：（CSV格式）选择分隔符（逗号、制表符等）
4. 点击"导出"按钮
5. 选择保存位置和文件名
6. 点击"保存"完成导出
7. 导出成功后会显示确认消息

### 导出格式说明

- **TXT 格式**：纯文本文件，每行一首歌曲，适合简单分享或导入到其他文本处理应用
- **CSV 格式**：可用 Excel 等电子表格软件打开，包含歌曲名称、艺术家、专辑、时长等完整信息

### 导出选项详解

1. **歌名-歌手格式**：`Shape of You - Ed Sheeran`
2. **歌手-歌名格式**：`Ed Sheeran - Shape of You`
3. **歌名-歌手-专辑格式**：`Shape of You - Ed Sheeran - ÷ (Divide)`

### 批量导出

目前应用不支持一次性导出多个播放列表，您需要逐个选择播放列表进行导出。

## 应用设置

点击右上角的设置图标可以访问设置页面：

### 语言设置

- 选择应用程序界面语言（中文或英文）
- 更改后立即生效，无需重启
- 系统会记住您的语言选择，下次启动时自动应用

### 导出设置

- 设置默认导出格式（歌名-歌手、歌手-歌名等）
- 选择默认文件类型（TXT 或 CSV）
- 设置CSV默认分隔符
- 设置是否默认包含标题行

### 日志设置

- 调整日志级别（调试、信息、警告、错误）
  - **调试**：记录所有详细信息，适用于排查问题
  - **信息**：记录一般操作信息（推荐设置）
  - **警告**：仅记录警告和错误
  - **错误**：仅记录错误信息
- 查看日志文件，帮助排查问题
- 日志文件存储在应用程序目录的 `log` 文件夹中

### 缓存管理

- 查看缓存大小
- 清理缓存，释放磁盘空间
- 缓存包括播放列表数据、歌曲信息和图片
- 清理缓存不会影响您的Spotify账号或播放列表

### 高级设置

- 重置应用程序设置
- 查看应用程序版本信息
- 访问开发者选项（如果启用）

## 常见问题

### 账号和授权问题

#### 问：我需要Spotify高级账号才能使用这个工具吗？

答：不需要。SpotifyExportTool可以与免费或高级Spotify账号一起使用。唯一的区别是，高级账号用户可能拥有更多的播放列表和收藏歌曲。

#### 问：应用程序会存储我的Spotify密码吗？

答：不会。SpotifyExportTool使用OAuth2授权流程，不会存储或访问您的Spotify密码。授权过程在Spotify官方网站上完成，应用程序只接收授权令牌。

#### 问：如何注销当前账号？

答：点击右上角的用户头像，然后选择"注销"选项。这将删除存储的授权令牌，您需要重新登录才能使用应用程序。

### 播放列表问题

#### 问：为什么我看不到我的某些播放列表？

答：SpotifyExportTool 只能访问您自己创建的播放列表或您关注的播放列表。如果某些播放列表不可见，可能是因为：
1. 它们是私有的或您没有访问权限
2. Spotify API限制导致某些播放列表未能加载
3. 播放列表可能是由其他应用创建的，未在Spotify库中显示

#### 问：我刚在Spotify中创建了新播放列表，但在应用中看不到？

答：点击侧边栏顶部的刷新按钮，更新播放列表数据。如果仍然看不到，请等待几分钟后再次刷新，因为Spotify API可能需要一些时间来同步新创建的播放列表。

#### 问：播放列表中的歌曲数量与Spotify显示的不一致？

答：这可能是因为：
1. Spotify API可能不返回某些无法播放的曲目
2. 区域限制的歌曲可能不会显示
3. Spotify的API有时会有延迟，未反映最新更改

### 导出问题

#### 问：导出的文件中有些歌曲信息不完整？

答：这可能是因为Spotify API提供的数据不完整。某些歌曲可能缺少专辑信息或其他元数据。这通常发生在较旧的曲目或不太知名的音乐上。

#### 问：如何导出超过10,000首歌曲的播放列表？

答：由于Spotify API的限制，单次请求最多只能获取10,000首歌曲。对于超大型播放列表，应用程序会尝试分批获取，但可能无法完全导出所有歌曲。在这种情况下，您可以尝试将播放列表分割成多个较小的播放列表。

#### 问：导出的CSV文件在Excel中显示乱码？

答：这可能是因为编码问题。尝试在Excel中打开文件时，选择"数据"选项卡，然后使用"自文本"功能，并指定UTF-8编码。

### 性能问题

#### 问：应用程序运行缓慢怎么办？

答：尝试以下方法：
1. 清理缓存（在设置页面中）
2. 确保您的网络连接良好
3. 重启应用程序
4. 检查您的系统资源使用情况，关闭不必要的程序
5. 如果问题持续，尝试降低日志级别（在设置中）

#### 问：应用程序占用了太多内存？

答：SpotifyExportTool会缓存播放列表和图片数据以提高性能。如果内存使用过高，请尝试：
1. 清理缓存（在设置页面中）
2. 重启应用程序
3. 如果您有大量播放列表，考虑减少同时打开的播放列表数量

## 故障排除

### 登录问题

如果无法登录：
1. 确保您的网络连接正常
2. 检查Spotify服务是否可用（访问[Spotify状态页面](https://status.spotify.com/)）
3. 尝试重新启动应用程序
4. 检查日志文件中的错误信息
5. 确保您的系统时间是准确的
6. 尝试清除浏览器缓存，然后重新授权
7. 如果使用代理或VPN，尝试暂时禁用它们

### 导出失败

如果导出过程失败：
1. 确保您有写入所选目录的权限
2. 检查磁盘空间是否足够
3. 尝试选择不同的保存位置
4. 检查文件名是否包含无效字符
5. 检查日志文件中的错误信息
6. 尝试导出较小的播放列表，看问题是否与播放列表大小有关

### 应用程序崩溃

如果应用程序崩溃：
1. 检查`log`目录中的崩溃报告和错误日志
2. 重新启动应用程序
3. 如果问题持续，尝试以下步骤：
   - 清理缓存
   - 重新安装应用程序
   - 检查是否有系统更新或Python更新（如果从源码运行）
   - 在不同的目录中安装应用程序

### 资源文件问题

如果图标或界面元素显示不正确：
1. 确保安装包完整，没有缺少文件
2. 检查`assets`目录是否存在并包含所有必要的资源文件
3. 尝试重新安装应用程序
4. 如果从源码运行，确保您已安装所有必要的依赖

### 网络连接问题

如果应用程序无法连接到Spotify：
1. 检查您的网络连接
2. 确保没有防火墙阻止应用程序访问网络
3. 如果使用代理，检查代理设置
4. 尝试重新启动路由器或使用不同的网络连接

## 快捷键

SpotifyExportTool支持以下快捷键：

- **F5**：刷新当前播放列表
- **Ctrl+E**（Windows）/ **Cmd+E**（Mac）：导出当前播放列表
- **Ctrl+,**（Windows）/ **Cmd+,**（Mac）：打开设置
- **Ctrl+H**（Windows）/ **Cmd+H**（Mac）：返回主页
- **Ctrl+Q**（Windows）/ **Cmd+Q**（Mac）：退出应用程序
- **Ctrl+L**（Windows）/ **Cmd+L**（Mac）：注销
- **Ctrl+F**（Windows）/ **Cmd+F**（Mac）：聚焦搜索框

## 隐私说明

SpotifyExportTool尊重您的隐私：

- 应用程序只请求必要的Spotify数据访问权限
- 不会收集或上传您的个人信息
- 所有数据都存储在您的本地设备上
- 授权令牌安全存储在本地，不会与任何第三方共享
- 应用程序不会修改您的Spotify账号或播放列表

---

如果您遇到本指南未涵盖的问题，请在[GitHub Issues](https://github.com/Cail-Gainey/SpotifyExportTool/issues)页面提交问题报告。 